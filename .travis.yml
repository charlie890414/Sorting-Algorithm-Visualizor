os: windows
language: shell
script:
  - ./make_Help_CD.bat
  - ./make_keyEvents_CD.bat
  - ./make_DelayAndEvent_CD.bat
  - ./make_BubbleSort_CD.bat
  - ./make_main_CD.bat
  - choco install -y windows-sdk-10.1
  - powershell -Command 'Set-ExecutionPolicy -ExecutionPolicy RemoteSigned'
  - powershell ./windows.ps1
  - "C:\\Program Files (x86)\\Windows Kits\10\\bin\\10.0.18362.0\\x86\\signtool" sign -t http://timestamp.comodoca.com/authenticode -f certificate.pfx Sorting.Algorithm.Visualizor.exe
deploy:
  provider: releases
  skip_cleanup: true
  token: $GH_TOKEN
  file_glob: true
  file:
    - Sorting.Algorithm.Visualizor.exe
  on:
    tags: true